<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pod Performance Analysis Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font import for a clean look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb; /* Light background */
        }
        .metric-bar {
            height: 10px;
            border-radius: 9999px;
            transition: width 0.5s ease-out;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
        }
        /* Color classes for better visualization */
        .color-p1 { background-color: #10b981; } /* Emerald */
        .color-p2 { background-color: #3b82f6; } /* Blue */
        .color-p3 { background-color: #ef4444; } /* Red */

        /* --- Print-Specific Styles --- */
        @media print {
            /* Now includes the header and KPI cards */

            /* Reset body and app container for printing */
            body {
                background-color: #ffffff !important; /* Print on white */
                padding: 0;
                margin: 0;
            }
            
            #app {
                max-width: 100% !important;
                margin: 0;
                padding: 0;
            }

            /* Style the table section for printing */
            section.bg-white {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 1rem;
                margin: 0;
                width: 100%;
                overflow-x: visible !important;
            }

            /* --- Force browser to print background colors --- */
            .metric-bar, .bg-gray-100, .bg-gray-50, .bg-amber-200 { /* Updated to include amber for print */
                -webkit-print-color-adjust: exact; /* Chrome, Safari, Edge */
                print-color-adjust: exact; /* Firefox */
            }
            
            /* Remove hover effects */
            tr.hover\\:bg-indigo-50:hover {
                --tw-bg-opacity: 1;
                background-color: rgb(255 255 255 / var(--tw-bg-opacity)) !important;
            }
            
            /* FIX: Ensure table layout is fixed and cell content wraps */
            #metrics-table {
                width: 100%;
                table-layout: fixed !important; 
            }

            #metrics-table td, #metrics-table th {
                white-space: normal !important; /* Override Tailwind's whitespace-nowrap */
                word-break: break-word; /* Force long words/metrics to wrap */
                padding-left: 0.5rem; /* Reduce padding for tighter print layout */
                padding-right: 0.5rem; 
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="max-w-7xl mx-auto">
        <!-- Header --><header class="mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800">POD Performance Dashboard</h1>
            <p class="text-lg text-gray-500 mt-1">Comparative Analysis Across Pods 1, 2, & 3</p>
        </header>

        <!-- KPI Cards --><section id="kpi-cards" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <!-- Cards will be injected here by JS --></section>

        <!-- Detailed Metrics Table --><section class="bg-white p-6 rounded-xl card-shadow overflow-x-auto">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Detailed Metrics Breakdown</h2>
            <table id="metrics-table" class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <!-- Mobile padding reduced to px-2 --><th class="px-2 py-3 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Metric</th>
                        <th class="px-2 py-3 sm:px-6 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Pod 1</th>
                        <th class="px-2 py-3 sm:px-6 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Pod 2</th>
                        <th class="px-2 py-3 sm:px-6 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Pod 3</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <!-- Rows will be injected here by JS --></tbody>
            </table>
        </section>
        
    </div>

    <script>
        // Data parsed from the original report
        const rawData = {
            'Total Appointment Volume': [174, 160, 143],
            'Same Day Same Pod Appointments': [1, 1, 4],
            'Production Per Appointment': [527.07, 492.47, 506.76],
            'Total Gross Production': [91711, 78795, 72467],
            'Operative Appointment Volume': [66, 66, 55],
            'Operative Production Hours': [104, 120, 128],
            'Op Production Per Production Hour': [544.45, 461.79, 360.83],
            'Gross Operative Production': [56622.00, 55415.00, 46186.00],
            'Hyg Production Per Production Hour': [215.84, 205.58, 176.92],
            'Gross Hygiene Production': [29354.00, 23025.00, 21230.00],
        };

        const podColors = ['bg-emerald-500', 'bg-blue-500', 'bg-red-500'];
        const podLabels = ['Pod 1', 'Pod 2', 'Pod 3'];

        /**
         * Formats a number into a currency string or a plain integer string.
         * @param {number} value - The number to format.
         * @param {string} key - The metric key to determine formatting.
         * @returns {string} The formatted string.
         */
        function formatValue(value, key) {
            // Explicitly define which metrics should be treated as currency
            const currencyKeys = [
                'Production Per Appointment',
                'Total Gross Production',
                'Op Production Per Production Hour',
                'Gross Operative Production',
                'Hyg Production Per Production Hour',
                'Gross Hygiene Production',
            ];
            
            const isCurrency = currencyKeys.includes(key);

            if (isCurrency) {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    // Use 2 decimal places for per-unit rates, otherwise 0 (for total gross production)
                    minimumFractionDigits: key.includes('Per') ? 2 : 0,
                }).format(value);
            }
            // All other metrics (volume, hours, etc.) are formatted as general numbers (rounded)
            return new Intl.NumberFormat('en-US').format(Math.round(value));
        }

        /**
         * Creates a visual bar element for magnitude comparison.
         * @param {number} value - The current value.
         * @param {number[]} allValues - Array of all values for the metric.
         * @param {number} podIndex - Index of the current pod (0, 1, 2).
         * @returns {string} The HTML string for the bar and value.
         */
        function createValueCell(value, allValues, podIndex, key) {
            const max = Math.max(...allValues);
            const percentage = (value / max) * 100;
            const formattedValue = formatValue(value, key);

            // Determine if the value is the max (for subtle highlight)
            const isMax = value === max && max > 0;
            const highlightClass = isMax ? 'font-bold text-gray-900' : 'text-gray-600'; // Made text-900 for stronger contrast

            return `
                <div class="flex flex-col items-center">
                    <!-- Text size is text-xs on mobile, text-sm on sm and up --><span class="${highlightClass} text-xs sm:text-sm mb-1">${formattedValue}</span>
                    <div class="w-full h-2 bg-gray-100 rounded-full">
                        <div 
                            class="metric-bar ${podColors[podIndex]}" 
                            style="width: ${percentage}%;"
                            title="${formattedValue} (${percentage.toFixed(1)}% of max)"
                        ></div>
                    </div>
                </div>
            `;
        }

        /**
         * Renders the Detailed Metrics Table.
         */
        function renderTable() {
            const tableBody = document.querySelector('#metrics-table tbody');
            tableBody.innerHTML = '';

            for (const key in rawData) {
                const values = rawData[key];
                const max = Math.max(...values); // Find the max value
                const maxIndex = values.indexOf(max); // Find the index of the winner (first occurrence)

                const row = document.createElement('tr');
                row.className = 'hover:bg-indigo-50 transition duration-150';

                // Metric Name Cell - Using responsive padding/text size
                let rowHtml = `<td class="px-2 py-3 sm:px-6 sm:py-4 text-xs sm:text-sm font-medium text-gray-900">${key}</td>`;

                // Value Cells for each Pod
                values.forEach((value, index) => {
                    // Determine if this is the winning cell
                    const isWinner = (index === maxIndex) && (max > 0);
                    
                    // Apply strong visual winner highlight if applicable - now using amber
                    const winnerClass = isWinner 
                        ? 'bg-amber-100 border-2 border-amber-400 rounded-lg shadow-inner' 
                        : '';

                    rowHtml += `<td class="px-2 py-3 sm:px-6 sm:py-4 text-xs sm:text-sm ${winnerClass}">
                        ${createValueCell(value, values, index, key)}
                    </td>`;
                });

                row.innerHTML = rowHtml;
                tableBody.appendChild(row);
            }
        }

        /**
         * Renders the Key Performance Indicator (KPI) Cards.
         */
        function renderKpiCards() {
            const kpiContainer = document.getElementById('kpi-cards');
            kpiContainer.innerHTML = '';

            const grossProdValues = rawData['Total Gross Production'];
            
            grossProdValues.forEach((value, index) => {
                const formattedValue = formatValue(value, 'Total Gross Production');
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-xl card-shadow border-t-4 border-b-4 ' + podColors[index].replace('bg-', 'border-');

                card.innerHTML = `
                    <p class="text-xl font-medium text-gray-500">${podLabels[index]}</p>
                    <h3 class="text-4xl font-extrabold text-gray-900 mt-2">${formattedValue}</h3>
                    <p class="text-sm text-gray-400 mt-2">Total Gross Production</p>
                `;
                kpiContainer.appendChild(card);
            });
        }

        // Initialize the dashboard on load
        window.onload = function() {
            renderKpiCards();
            renderTable();
        };

    </script>

</body>
</html>
